#!/usr/bin/env python3
# chatbot_assistente_emocional.py
import re
import time

def ask(prompt):
    return input(prompt + "\n> ").strip().lower()

def pausa(texto):
    """Simula um tempo de resposta do bot"""
    print(texto)
    time.sleep(1)

def detectar_humor(texto):
    """Analisa o humor com base na resposta do usu√°rio"""
    humor_positivo = ["bem", "√≥timo", "otimo", "beleza", "tranquilo", "show", "maravilha", "feliz", "excelente"]
    humor_negativo = ["mal", "cansado", "triste", "ruim", "p√©ssimo", "pessimo", "estressado", "irritado"]
    for palavra in humor_positivo:
        if palavra in texto:
            return "positivo"
    for palavra in humor_negativo:
        if palavra in texto:
            return "negativo"
    return "neutro"

def main():
    state = "SAUDACAO"
    nome = None
    problema = {"tipo": None, "descricao": None, "solucao": None}

    print("üßë‚Äçüíª Iniciando atendimento do Bot Assistene...\n")

    while True:
        # ETAPA 1 ‚Äì Pergunta o nome
        if state == "SAUDACAO":
            nome = input("Bot: Antes de come√ßarmos, qual o seu nome?\n> ").strip().title()
            if nome:
                pausa(f"\nBot: Ol√° {nome}, tudo bem? üëã")
                state = "RESPOSTA_SAUDACAO"
            else:
                pausa("Bot: Por favor, digite um nome v√°lido.")

        # ETAPA 2 ‚Äì Resposta ao cumprimento com detec√ß√£o emocional
        elif state == "RESPOSTA_SAUDACAO":
            resposta = ask(f"{nome}")
            humor = detectar_humor(resposta)

            if humor == "positivo":
                pausa(f"Bot: Que √≥timo, {nome}! üòÑ Fico feliz em saber que voc√™ est√° bem.")
                pausa("Bot: Vamos ver em que posso te ajudar hoje!")
            elif humor == "negativo":
                pausa(f"Bot: Poxa, {nome} üòî Sinto muito em saber disso.")
                pausa("Bot: Espero poder te ajudar a resolver tudo e melhorar seu dia üí™")
            else:
                pausa(f"Bot: Entendo, {nome}. Vamos cuidar do seu problema juntos üòâ")

            state = "MENU_PROBLEMA"

        # ETAPA 3 ‚Äì Menu de problemas
        elif state == "MENU_PROBLEMA":
            pausa(f"\nBot: {nome}, com o que voc√™ precisa de ajuda hoje?")
            print("""
1Ô∏è‚É£ - Problema com a Internet
2Ô∏è‚É£ - Problema com a Impressora
3Ô∏è‚É£ - Problema de Login
4Ô∏è‚É£ - Computador Lento
5Ô∏è‚É£ - Sem Som
6Ô∏è‚É£ - Problema com E-mail
7Ô∏è‚É£ - Sistema Operacional travando
""")
            opcao = ask("Digite o n√∫mero da op√ß√£o desejada (1 a 7)")

            # Internet
            if opcao == "1":
                problema["tipo"] = "internet"
                problema["solucao"] = (
                    "üåê Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Verifique se o roteador est√° ligado.\n"
                    "2Ô∏è‚É£ Reinicie o modem e aguarde 2 minutos.\n"
                    "3Ô∏è‚É£ Teste em outro dispositivo."
                )
                pausa(f"Bot: Entendido, {nome}. √â um problema de internet.")
                state = "FORNECER_SOLUCAO"

            # Impressora
            elif opcao == "2":
                problema["tipo"] = "impressora"
                problema["solucao"] = (
                    "üñ®Ô∏è Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Confira se a impressora est√° ligada e conectada.\n"
                    "2Ô∏è‚É£ Verifique papel e tinta.\n"
                    "3Ô∏è‚É£ Reinicie a impressora e tente novamente."
                )
                pausa(f"Bot: Certo, {nome}. Vamos resolver o problema com a impressora.")
                state = "FORNECER_SOLUCAO"

            # Login
            elif opcao == "3":
                problema["tipo"] = "login"
                problema["solucao"] = (
                    "üîë Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Verifique se o CAPS LOCK est√° desligado.\n"
                    "2Ô∏è‚É£ Tente redefinir a senha.\n"
                    "3Ô∏è‚É£ Contate o administrador se persistir."
                )
                pausa(f"Bot: Entendido, {nome}. √â um problema de login.")
                state = "FORNECER_SOLUCAO"

            # Computador lento
            elif opcao == "4":
                problema["tipo"] = "desempenho"
                problema["solucao"] = (
                    "üíª Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Feche programas desnecess√°rios.\n"
                    "2Ô∏è‚É£ Desative inicializa√ß√µes autom√°ticas.\n"
                    "3Ô∏è‚É£ Fa√ßa uma limpeza de disco ou verifique v√≠rus."
                )
                pausa(f"Bot: Vamos ver como acelerar seu computador, {nome}.")
                state = "FORNECER_SOLUCAO"

            # Sem som
            elif opcao == "5":
                problema["tipo"] = "som"
                problema["solucao"] = (
                    "üîä Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Verifique se o volume est√° ativo.\n"
                    "2Ô∏è‚É£ Confira se o cabo ou fone est√° conectado corretamente.\n"
                    "3Ô∏è‚É£ Atualize o driver de √°udio."
                )
                pausa(f"Bot: Ok, {nome}. Vamos corrigir o problema de som.")
                state = "FORNECER_SOLUCAO"

            # E-mail
            elif opcao == "6":
                problema["tipo"] = "email"
                problema["solucao"] = (
                    "üìß Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Confira a conex√£o com a internet.\n"
                    "2Ô∏è‚É£ Verifique usu√°rio e senha.\n"
                    "3Ô∏è‚É£ Teste o envio em outro navegador ou aplicativo."
                )
                pausa(f"Bot: Entendido, {nome}. Vamos ver o problema de e-mail.")
                state = "FORNECER_SOLUCAO"

            # Sistema Operacional
            elif opcao == "7":
                problema["tipo"] = "sistema"
                problema["solucao"] = (
                    "üß© Solu√ß√µes poss√≠veis:\n"
                    "1Ô∏è‚É£ Reinicie o computador.\n"
                    "2Ô∏è‚É£ Verifique atualiza√ß√µes pendentes.\n"
                    "3Ô∏è‚É£ Execute uma verifica√ß√£o de integridade do sistema."
                )
                pausa(f"Bot: Ok, {nome}. Vamos corrigir o travamento do sistema.")
                state = "FORNECER_SOLUCAO"

            else:
                pausa("‚ùå Bot: N√£o entendi, por favor digite um n√∫mero entre 1 e 7.")
                continue

        # ETAPA 4 ‚Äì Exibe a solu√ß√£o
        elif state == "FORNECER_SOLUCAO":
            print(f"\nBot: Aqui est√£o algumas dicas que podem ajudar, {nome}:")
            print(problema["solucao"])
            txt = ask(f"\n{nome}, o problema foi resolvido? (sim/n√£o)")
            if "sim" in txt:
                pausa(f"Bot: Que √≥timo, {nome}! Fico feliz em ajudar üòÑ")
                state = "FINALIZADO"
            elif "n√£o" in txt or "nao" in txt:
                pausa(f"Bot: Entendido, {nome}. Deseja encaminhar o caso para o suporte avan√ßado?")
                state = "ESCALAR_SUPORTE"
            else:
                pausa("‚ùå Bot: N√£o entendi sua resposta, por favor digite 'sim' ou 'n√£o'.")

        # ETAPA 5 ‚Äì Escalar para suporte
        elif state == "ESCALAR_SUPORTE":
            txt = ask(f"{nome}, deseja que eu encaminhe para o suporte t√©cnico? (sim/n√£o)")
            if "sim" in txt:
                pausa(f"Bot: Chamado aberto para o suporte t√©cnico, {nome}. Aguarde atendimento üë®‚Äçüíª")
                state = "FINALIZADO"
            elif "n√£o" in txt or "nao" in txt:
                pausa(f"Bot: Tudo bem, {nome}. Se precisar, estarei por aqui üòâ")
                state = "FINALIZADO"
            else:
                pausa("‚ùå Bot: N√£o entendi, responda com 'sim' ou 'n√£o'.")

        # ETAPA FINAL ‚Äì Pergunta se deseja outro atendimento
        elif state == "FINALIZADO":
            resposta = ask(f"\n{nome}, deseja falar sobre outro problema? (sim/n√£o)")
            if "sim" in resposta:
                pausa(f"Bot: Perfeito, {nome}! Vamos l√° novamente üí™")
                state = "MENU_PROBLEMA"
            elif "n√£o" in resposta or "nao" in resposta:
                pausa(f"Bot: Obrigado por usar o Bot Assistene, {nome}. Tenha um excelente dia! üëã")
                break
            else:
                pausa("‚ùå Bot: N√£o entendi, digite 'sim' ou 'n√£o'.")

if __name__ == "__main__":
    main()
